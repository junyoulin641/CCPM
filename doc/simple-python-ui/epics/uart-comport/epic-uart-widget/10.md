---
name: Set up QThread and SerialWorker skeleton
status: open
created: 2025-12-24T03:41:21Z
updated: 2025-12-24T07:56:24Z
github: https://github.com/junyoulin641/CCPM/issues/10
depends_on: [9]
parallel: false
conflicts_with: []
---

# Task: Set up QThread and SerialWorker skeleton

## Description
Create the SerialWorker class (QObject) that will handle all serial I/O operations in a separate thread. Set up the QThread infrastructure in UARTWidget to move the worker to the thread. At this stage, implement only the skeleton (class structure, signals, slots) without actual serial I/O logic.

## Acceptance Criteria
- [ ] SerialWorker class defined (inherits from QObject)
- [ ] Signals defined: dataReceived(str), errorOccurred(str), statusChanged(str)
- [ ] Slot methods defined (empty implementations): connectPort, disconnectPort, sendData
- [ ] QThread instance created in UARTWidget.__init__()
- [ ] SerialWorker instance created and moved to thread via moveToThread()
- [ ] Thread started in UARTWidget.__init__()
- [ ] Thread cleanup implemented in UARTWidget closeEvent()

## Technical Details
**Implementation approach:**
```python
class SerialWorker(QObject):
    # Signals
    dataReceived = pyqtSignal(str)
    errorOccurred = pyqtSignal(str)
    statusChanged = pyqtSignal(str)

    def __init__(self):
        super().__init__()
        self.running = False

    @pyqtSlot(str, int)
    def connectPort(self, port, baud):
        # Placeholder - will implement in later task
        pass

    @pyqtSlot()
    def disconnectPort(self):
        # Placeholder
        pass

    @pyqtSlot(str)
    def sendData(self, data):
        # Placeholder
        pass
```

**In UARTWidget.__init__():**
```python
self.worker_thread = QThread()
self.serial_worker = SerialWorker()
self.serial_worker.moveToThread(self.worker_thread)
self.worker_thread.start()
```

**Key considerations:**
- Worker must NOT have direct reference to UI elements (thread safety)
- All communication via signals/slots
- Ensure thread cleanup on widget close to avoid resource leaks

**Code locations/files affected:**
- `uart_widget.py`: Add SerialWorker class, modify UARTWidget.__init__()

## Dependencies
- [ ] Task 001 completed (uart_widget.py module exists)
- [ ] PyQt6.QtCore imported

## Effort Estimate
- Size: S
- Hours: 1 hour
- Parallel: false (depends on 001)

## Definition of Done
- [ ] Code implemented
- [ ] SerialWorker signals/slots defined
- [ ] QThread setup complete
- [ ] Thread starts without errors
- [ ] Thread cleanup works (no warnings on widget close)
